service: backend-lambda

provider:
  name: aws
  runtime: nodejs18.x
  region: eu-west-3
  stage: dev
  environment:
    NODE_ENV: production
    # IMPORTANT: ne pas committer de secrets en clair.
    # Les variables ci-dessous sont inject√©es au moment du deploy (GitHub Actions)
    # et deviennent les variables d'environnement de la Lambda.
    DATABASE_NAME: ${env:DATABASE_NAME, 'postgres'}
    DATABASE_USER: ${env:DATABASE_USER, 'postgres'}
    DATABASE_PASSWORD: ${env:DATABASE_PASSWORD}
    DATABASE_HOST: ${env:DATABASE_HOST, 'db.wvvawjjfpdgcdnmedboh.supabase.co'}
    DATABASE_PORT: ${env:DATABASE_PORT, 5432}
    PROTOCOLE: ${env:PROTOCOLE, 'https'}
    CORS_ORIGIN: ${env:CORS_ORIGIN}
    CLIENT_IP: ${env:CLIENT_IP, ''}
    CLIENT_PORT: ${env:CLIENT_PORT, ''}
    SERVER_PORT: ${env:SERVER_PORT, 8080}
    SERVER_HOST: ${env:SERVER_HOST, ''}
    JWT_SECRET: ${env:JWT_SECRET}
    JWT_REFRESH_SECRET: ${env:JWT_REFRESH_SECRET}


functions:
  api:
    handler: handler.handler
    url: true
